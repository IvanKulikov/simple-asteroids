<html>
	<head>
		<script src='js/asteroid.js'></script>
		<script src='js/player.js'></script>
	</head>
	<body>
		<canvas id="canvas" width="640px" height="480px">Get a real browser already will ya?</canvas>
	</body>
	<script>
			
		// Spawn
		var ctx = document.getElementById('canvas').getContext("2d");
		var rocks = [];
		var pl = new player(400, 400, 270);
		
		(function spawn(num) {
			for (var i = 0; i < num; i++)
				rocks.push(new asteroid(Math.random() * ctx.canvas.width, Math.random() * ctx.canvas.height, 10, 30, Math.random() * 360));
		})(25);
				
		(function render() {
			drawLoop(ctx);
			requestAnimationFrame(render);
		})();
		
		// draw loop
		function drawLoop(ctx) {
			ctx.fillStyle = '#000000';
			ctx.fillRect(0, 0, ctx.canvas.width, ctx.canvas.height);
			pl.draw(ctx);
			for (var i = 0; i < rocks.length; i++)
				rocks[i].draw(ctx);
		};
		
		var acc = false;
		var r = false;
		var l = false;
		
		
		// logic loop
		setInterval(function() {	
			pl.move();
			
			if (acc)
				pl.accelerate();
			if (r)
				pl.rotate(0);
			if (l)
				pl.rotate(1);
			
			for (var i = 0; i < rocks.length; i++)
				rocks[i].move();
		}, 60);
		
		window.onkeydown = function(e) {
			switch(e.keyCode) {
				case 38:
					acc = true;
					break;
				case 39: //right
					r = true;
					break;
				case 37: //right
					l = true;
					break;
			}			
		}
		
		window.onkeyup = function(e) {
			switch(e.keyCode) {
				case 38:
					acc = false;
					break;
				case 39: //right
					r = false;
					break;
				case 37: //right
					l = false;
					break;
			}			
		}
	</script>
</html>